<!DOCTYPE html>
<html>

<head>
<title>ATK Technician Portal</title>

<!-- ðŸš« BLOCK direct URL before page loads -->
<script>
if (sessionStorage.getItem("atkTech") !== "1") {
  window.location.replace("tech-login.html");
}
</script>

<style>
html{ display:none; }

html, body{
  margin:0;
  padding:0;
  width:100%;
  background:#111;
  color:white;
  font-family:Arial;
  overflow-x:hidden;
}

body{ padding:20px; }

input{padding:8px;width:200px;margin-bottom:10px;}
td,th{border:1px solid #555;padding:6px;}
th{background:#222;}
.orig{color:#888;font-size:12px;}

.tableWrap{
  width:100%;
  overflow-x:auto;
  overflow-y:hidden;
}

table{
  border-collapse:collapse;
  width:1800px;
  min-width:1800px;
}

th:nth-child(3), td:nth-child(3){ width:180px; }
th:nth-child(4), td:nth-child(4){ width:160px; }
th:nth-child(6), td:nth-child(6){ width:320px; }
th:nth-child(7), td:nth-child(7){ width:520px; }
th:nth-child(8), td:nth-child(8){ width:130px; }

.tag{
  padding:6px 10px;
  border-radius:15px;
  margin:3px;
  display:inline-block;
  cursor:pointer;
  color:#fff;
  font-size:12px;
}
.tagPanel{
  background:#222;
  padding:10px;
  display:flex;
  flex-wrap:wrap;
  max-height:200px;
  overflow:auto;
}

.problemBox{
  width:100%;
  min-height:70px;
  resize:vertical;
  border:none;
  padding:6px;
  box-sizing:border-box;
  line-height:1.4;
}
</style>

<!-- ðŸ” FIREBASE TECHNICIAN GUARD -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyC3PzfKBSKGVnYjfwaeKxEMA-JJrmhNScw",
  authDomain: "atk-drone-service-portal.firebaseapp.com",
  projectId: "atk-drone-service-portal"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* Firebase session verification */
onAuthStateChanged(auth, user => {
  if (!user) {
    sessionStorage.removeItem("atkTech");
    window.location.replace("tech-login.html");
    return;
  }

  const username = user.email.split("@")[0];

  if (username !== "lakz") {
    alert("Access denied");
    sessionStorage.removeItem("atkTech");
    signOut(auth).then(() => {
      window.location.replace("tech-login.html");
    });
    return;
  }

  /* âœ… All security checks passed */
  document.documentElement.style.display = "block";
});
</script>

</head>

<body>

<h2>ATK Technician Portal</h2>
<input id="search" placeholder="Search Ticket / Name">

<div class="tableWrap">
<table>
<thead>
<tr>
<th>Date</th>
<th>Ticket</th>
<th>Name</th>
<th>Drone</th>
<th>RC</th>
<th>Accessories</th>
<th>Problem</th>
<th>Phone</th>
<th>Status</th>
<th>User</th>
</tr>
</thead>
<tbody id="results"></tbody>
</table>
</div>

<div id="rcPanel" class="tagPanel"></div>
<div id="accPanel" class="tagPanel"></div>

<script type="module" src="technician.js"></script>

</body>
</html>
